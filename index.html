<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Something to Report</title>
  <meta name="description" content="Headlines with sources, summaries, and a clean three-day layout." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Merriweather:wght@700;900&display=swap" rel="stylesheet">
  <script>(()=>{const m=localStorage.getItem("mode");if(m==="dark")document.documentElement.setAttribute("data-theme","dark");})();</script>
  <style>
    :root{
      --bg:#f7f7f5; --fg:#1f2328; --muted:#5b6270;
      --brand:#8b0000; --brand-strong:#6f0000; --link:var(--brand);
      --card:#ffffff; --ring:#e5e7eb;
      --shadow:0 14px 40px rgba(139,0,0,.08), 0 6px 20px rgba(0,0,0,.06);
      --radius:16px; --pad:clamp(16px,3vw,32px); --maxw:1180px;
      --h1:clamp(32px,6vw,66px); --h3:clamp(17px,2.4vw,22px);
      --body:clamp(15px,1.9vw,17px); --small:clamp(12px,1.7vw,14px);
    }
    html[data-theme="dark"]{
      --bg:#10141c; --fg:#e8ebf0; --muted:#a6b0be;
      --card:#161d2b; --ring:#263149; --link:#ff7b73; --brand:#ff6b6b; --brand-strong:#ff8a8a;
      --shadow:0 18px 48px rgba(10,10,10,.45);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:400 var(--body)/1.65 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    a{color:var(--link);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:var(--maxw);margin:0 auto;padding:0 var(--pad)}
    /* Controls */
    .controls{position:sticky;top:0;z-index:50;backdrop-filter:blur(10px);background:color-mix(in oklab,var(--card) 85%,transparent);border-bottom:1px solid var(--ring)}
    .controls .row{display:flex;align-items:center;gap:10px;padding:10px var(--pad)}
    .search{flex:1;display:flex;gap:8px}
    .search input{flex:1;height:44px;border:1px solid var(--ring);border-radius:12px;background:var(--card);color:var(--fg);padding:0 14px}
    .btn{height:44px;border:1px solid var(--ring);border-radius:12px;background:var(--card);color:var(--fg);font-weight:700;padding:0 14px;cursor:pointer}
    .clock{font-size:var(--small);color:var(--muted)}
    /* Header */
    header{padding:24px 0;border-bottom:1px solid var(--ring)}
    .brand{font:900 var(--h1)/1.05 Merriweather,Georgia,serif;text-align:center;margin:0 0 6px}
    .dek{text-align:center;color:var(--muted);margin:0 auto;max-width:600px}
    /* Date Pills */
    .dates{display:flex;gap:8px;align-items:center;margin:12px auto 0;max-width:var(--maxw)}
    .pill{border:1px solid var(--ring);border-radius:999px;padding:8px 14px;background:var(--card);font-size:var(--small);font-weight:700;cursor:pointer}
    .pill.active{outline:2px solid var(--brand)}
    .stamp{margin-left:auto;font-size:var(--small);color:var(--muted)}
    /* Breaking */
    .panel{margin:14px auto 0;max-width:var(--maxw);background:var(--card);border:1px solid var(--ring);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .panel .bar{padding:14px 18px;font-weight:800;color:var(--brand-strong);border-bottom:1px dashed var(--ring)}
    .panel .body{padding:14px 18px;color:var(--muted);font-size:var(--small)}
    /* Sections */
    .sections{padding:20px 0}
    .grid{display:grid;grid-template-columns:1fr;gap:20px}
    @media(min-width:800px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:1100px){.grid{grid-template-columns:repeat(3,1fr)}}
    .card{background:var(--card);border:1px solid var(--ring);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
    .card h3{margin:0 0 10px;font:800 var(--h3)/1.2 Inter;text-transform:uppercase;color:var(--brand-strong)}
    .story{padding:10px 0;border-bottom:1px dashed var(--ring)}
    .story:last-child{border-bottom:none}
    .story .title{all:unset;cursor:pointer;font-weight:700}
    .story .title:hover{text-decoration:underline}
    .summary{display:none;margin-top:6px;color:var(--muted);font-size:var(--small)}
    .story.open .summary{display:block}
    .source{display:inline-block;margin-top:6px;font-size:var(--small);padding:4px 10px;border:1px solid var(--ring);border-radius:999px}
    .meta{font-size:var(--small);color:var(--muted);margin-top:8px;display:block}
    .no-results{display:none;margin-top:6px;font-size:var(--small);color:var(--muted)}
    /* Policy table */
    .table{width:100%;border-collapse:collapse;margin-top:28px;background:var(--card);border:1px solid var(--ring);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .table caption{padding:12px 16px;font-weight:800;color:var(--brand-strong);text-align:left}
    .table th,.table td{padding:12px 16px;text-align:left;border-bottom:1px solid var(--ring)}
    .table th{background:color-mix(in oklab,var(--brand) 6%,transparent)}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:color-mix(in oklab,var(--brand) 18%,transparent);color:var(--brand);font-size:var(--small);font-weight:800}
    .expand-wrap{text-align:center;margin:24px 0}
    footer{text-align:center;padding:24px 0 36px;color:var(--muted);font-size:var(--small)}
  </style>
</head>
<body>
  <!-- Controls -->
  <div class="controls">
    <div class="row">
      <div class="search"><input id="q" type="search" placeholder="Search headlinesâ€¦"><button class="btn" id="clear">Clear</button></div>
      <span class="clock" id="clock">Now â€” --:--</span>
      <button class="btn" id="darkToggle" aria-pressed="false">ðŸŒ™</button>
    </div>
  </div>

  <!-- Header -->
  <header>
    <div class="wrap">
      <h1 class="brand">Something to Report</h1>
      <p class="dek">Daily briefings with sources and quick summaries â€” updated every morning.</p>
    </div>
  </header>

  <!-- Dates -->
  <div class="wrap">
    <div class="dates" id="dates">
      <span class="stamp" id="stamp">Last updated --:--</span>
    </div>
  </div>

  <!-- Breaking (hidden if empty) -->
  <div class="wrap">
    <section class="panel" id="breakingPanel" hidden>
      <div class="bar" id="breakingBar"></div>
      <div class="body" id="breakingBody"></div>
    </section>
  </div>

  <!-- Sections -->
  <div class="wrap sections">
    <div class="grid" id="sections">
      <article class="card section" data-section="family"><h3>Family</h3><div class="list"></div><small class="meta">Family & parental policy updates.</small><div class="no-results">No family stories.</div></article>
      <article class="card section" data-section="education"><h3>Education</h3><div class="list"></div><small class="meta">Admissions, funding, school choice.</small><div class="no-results">No education stories.</div></article>
      <article class="card section" data-section="security"><h3>Security & Borders</h3><div class="list"></div><small class="meta">Defense, DHS, and state security efforts.</small><div class="no-results">No security stories.</div></article>
      <article class="card section" data-section="america"><h3>America First</h3><div class="list"></div><small class="meta">Economy, jobs, and U.S. policy.</small><div class="no-results">No America stories.</div></article>
      <article class="card section" data-section="global"><h3>Global Lens</h3><div class="list"></div><small class="meta">Foreign policy and world events.</small><div class="no-results">No global stories.</div></article>
      <article class="card section" data-section="journal"><h3>Journal & Ideas</h3><div class="list"></div><small class="meta">Culture, opinion, and long reads.</small><div class="no-results">No journal stories.</div></article>
    </div>
    <div class="expand-wrap"><button class="btn" id="toggleAll" aria-pressed="false">Expand all stories</button></div>
  </div>

  <!-- Policy Tracker -->
  <div class="wrap">
    <section aria-label="Policy Tracker">
      <table class="table">
        <caption>Policy Tracker</caption>
        <thead><tr><th>Topic</th><th>Status</th><th>Last Update</th></tr></thead>
        <tbody id="policyBody"></tbody>
      </table>
    </section>
  </div>

  <footer>Â© <span id="year"></span> Something to Report</footer>

  <script>
  const $=(s,el=document)=>el.querySelector(s);
  const $$=(s,el=document)=>[...el.querySelectorAll(s)];
  const pad=n=>String(n).padStart(2,"0");
  const fmtTime=d=>d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
  const toIso=d=>`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
  const toLabel=d=>`${pad(d.getMonth()+1)}-${pad(d.getDate())}-${d.getFullYear()}`;
  const clock=$("#clock"), stamp=$("#stamp");
  const tick=()=>clock.textContent=`Now â€” ${fmtTime(new Date())}`;
  tick(); setInterval(tick,1000);
  if(stamp) stamp.textContent=`Last updated ${fmtTime(new Date())}`;
  $("#year").textContent=new Date().getFullYear();

  // Dark mode
  const toggle=$("#darkToggle"), root=document.documentElement;
  if(localStorage.getItem("mode")==="dark") toggle.setAttribute("aria-pressed","true");
  toggle.addEventListener("click",()=>{const isDark=root.getAttribute("data-theme")==="dark";root.setAttribute("data-theme",isDark?"light":"dark");localStorage.setItem("mode",isDark?"light":"dark");toggle.setAttribute("aria-pressed",String(!isDark));});

  // Search
  const q=$("#q"), clearBtn=$("#clear");
  function textFilter(){const term=q.value.trim().toLowerCase();$$(".card.section").forEach(card=>{card.style.display=card.innerText.toLowerCase().includes(term)? "":"none";});}
  q.addEventListener("input",textFilter);clearBtn.addEventListener("click",()=>{q.value="";textFilter();q.focus();});

  // Date pills
  const datesEl=$("#dates");
  const params=new URLSearchParams(location.search);
  const preset=params.get("date");
  const today=new Date();const day=n=>{const d=new Date();d.setDate(today.getDate()-n);return d;};
  const three=[day(0),day(1),day(2)];
  const pills=[];
  three.forEach((d,i)=>{const pill=document.createElement("button");pill.type="button";pill.className="pill";const lbl=toLabel(d);pill.dataset.date=lbl;pill.textContent=i===0?`Latest: ${lbl}`:lbl;datesEl.insertBefore(pill,stamp);pills.push(pill);});

  // Fetch & render
  async function fetchNews(dateLabel){const [mm,dd,yyyy]=dateLabel.split("-");const isoDate=`${yyyy}-${mm}-${dd}`;const url=`./data/news-${isoDate}.json`;const res=await fetch(url,{cache:"no-store"});if(!res.ok)throw new Error("Missing JSON for "+isoDate);return res.json();}

  function renderCategory(catEl,items){const list=$(".list",catEl);list.innerHTML="";let shown=0;(items||[]).forEach(it=>{const wrap=document.createElement("div");wrap.className="story";const head=document.createElement("div");head.className="head";const btn=document.createElement("button");btn.className="title";btn.textContent=it.title||"(untitled)";const a=document.createElement("a");a.className="source";a.href=it.url||"#";a.target="_blank";a.rel="noopener";a.textContent=it.sourceLabel||"Source â†—";head.append(btn,a);const sum=document.createElement("div");sum.className="summary";sum.textContent=it.summary||"";wrap.append(head,sum);btn.addEventListener("click",()=>wrap.classList.toggle("open"));list.appendChild(wrap);shown++;});const empty=$(".no-results",catEl);if(empty)empty.style.display=shown?"none":"block";}

  function renderPolicyTable(data){const tbody=$("#policyBody");if(!tbody||!data.policy)return;tbody.innerHTML="";data.policy.forEach(row=>{const tr=document.createElement("tr");tr.innerHTML=`<td>${row.topic}</td><td><span class='badge'>${row.status}</span></td><td>${row.lastUpdate}</td>`;tbody.appendChild(tr);});}

  function renderAll(data){
    const panel=$("#breakingPanel");
    if(data.breaking&&data.breaking.title){panel.hidden=false;$("#breakingBar").textContent=data.breaking.title;$("#breakingBody").textContent=data.breaking.kicker||"";}
    else{panel.hidden=true;}
    const map={family:$('[data-section="family"]'),education:$('[data-section="education"]'),security:$('[data-section="security"]'),america:$('[data-section="america"]'),global:$('[data-section="global"]'),journal:$('[data-section="journal"]')};
    Object.entries(map).forEach(([key,el])=>{renderCategory(el,data[key]||[]);});
    renderPolicyTable(data);
  }

  async function applyDate(dateLabel){
    pills.forEach(p=>p.classList.toggle("active",p.dataset.date===dateLabel));
    const url=new URL(location.href);url.searchParams.set("date",dateLabel);history.replaceState(null,"",url.toString());
    try{const data=await fetchNews(dateLabel);renderAll(data);}catch(err){console.warn(err);renderAll({});}
  }

  pills.forEach(p=>p.addEventListener("click",()=>applyDate(p.dataset.date)));
  const initial=preset&&pills.some(p=>p.dataset.date===preset)?preset:pills[0]?.dataset.date;
  if(initial)applyDate(initial);

  // Expand/collapse all
  const toggleAll=$("#toggleAll");
  if(toggleAll){toggleAll.addEventListener("click",()=>{const open=toggleAll.getAttribute("aria-pressed")!=="true";toggleAll.setAttribute("aria-pressed",String(open));toggleAll.textContent=open?"Collapse all stories":"Expand all stories";$$(".story").forEach(st=>st.classList.toggle("open",open));});}
  </script>
</body>
</html>