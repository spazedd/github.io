<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Something to Report</title>
  <meta name="description" content="Headlines with sources, fast summaries, three-day view, and a clean policy tracker." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Merriweather:wght@700;900&display=swap" rel="stylesheet">
  <script>(()=>{const m=localStorage.getItem("mode");if(m==="dark")document.documentElement.setAttribute("data-theme","dark");})();</script>

  <style>
    :root{
      --bg:#f7f7f5; --fg:#1f2328; --muted:#5b6270;
      --brand:#8b0000; --brand-strong:#6f0000; --link:var(--brand);
      --card:#ffffff; --ring:#e5e7eb;
      --shadow:0 14px 40px rgba(139,0,0,.08), 0 6px 20px rgba(0,0,0,.06);
      --radius:16px; --pad:clamp(16px,3vw,32px); --maxw:1180px;
      --h1:clamp(32px,6vw,66px); --h3:clamp(17px,2.4vw,22px);
      --body:clamp(15px,1.9vw,17px); --small:clamp(12px,1.7vw,14px);
    }
    html[data-theme="dark"]{
      --bg:#10141c; --fg:#e8ebf0; --muted:#a6b0be;
      --card:#161d2b; --ring:#263149; --link:#ff7b73; --brand:#ff6b6b; --brand-strong:#ff8a8a;
      --shadow:0 18px 48px rgba(10,10,10,.45);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:400 var(--body)/1.65 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}
    a{color:var(--link);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:var(--maxw);margin:0 auto;padding:0 var(--pad)}

    .controls{position:sticky;top:0;z-index:60;backdrop-filter:blur(12px);background:color-mix(in oklab,var(--card) 78%,transparent);border-bottom:1px solid var(--ring);padding:12px var(--pad)}
    .controls .row{max-width:var(--maxw);margin:0 auto;display:flex;align-items:center;gap:12px;flex-wrap:wrap}
    .search{flex:1 1 280px;display:flex;gap:10px}
    .search input{width:100%;height:46px;padding:0 16px;border:1px solid var(--ring);border-radius:14px;background:var(--card);color:var(--fg);outline:none;box-shadow:inset 0 1px 2px rgba(0,0,0,.06)}
    .btn{display:inline-flex;align-items:center;justify-content:center;height:46px;padding:0 16px;gap:8px;background:var(--card);color:var(--fg);border:1px solid var(--ring);border-radius:14px;cursor:pointer;user-select:none;font-weight:600;transition:transform .2s ease,box-shadow .2s ease}
    .btn:hover{box-shadow:0 10px 24px rgba(139,0,0,.12)}
    .btn:active{transform:translateY(1px)}
    .clock{font-size:var(--small);color:var(--muted);padding:8px 0 8px 6px;white-space:nowrap}

    header{padding:calc(var(--pad) + 10px) 0 var(--pad);border-bottom:1px solid rgba(0,0,0,.06);background:radial-gradient(1400px 520px at 50% -260px,#fff 0,#f0f0f0 55%,#e9e9e9 100%) 0/cover,linear-gradient(120deg,rgba(139,0,0,.15),transparent)}
    html[data-theme="dark"] header{border-bottom:1px solid rgba(255,255,255,.06);background:radial-gradient(1400px 520px at 50% -260px,#1f2536 0,#151c2a 60%,#0f1420 100%) 0/cover,linear-gradient(120deg,rgba(255,107,107,.18),transparent)}
    .brand{font:900 var(--h1)/1.05 Merriweather,Georgia,serif;letter-spacing:.6px;text-transform:uppercase;margin:0 0 12px;text-align:center;color:var(--fg);text-shadow:0 14px 30px rgba(139,0,0,.18)}
    .dek{text-align:center;color:var(--muted);font-size:var(--body);max-width:920px;margin:0 auto;font-weight:500}

    .dates{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin:16px auto 0;max-width:var(--maxw)}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;cursor:pointer;white-space:nowrap;background:var(--card);border:1px solid var(--ring);color:var(--muted);font-size:var(--small);font-weight:600;transition:transform .2s ease,box-shadow .2s ease}
    .pill:hover{box-shadow:0 10px 24px rgba(139,0,0,.08)}
    .pill.active{outline:2px solid var(--brand);color:var(--fg)}
    .stamp{margin-left:auto;font-size:var(--small);color:var(--muted)}

    .panel{margin:18px auto 0;max-width:var(--maxw);background:var(--card);color:var(--fg);border:1px solid var(--ring);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .panel .bar{display:flex;gap:10px;align-items:center;padding:16px 20px;border-bottom:1px dashed var(--ring);font-size:clamp(16px,2.2vw,19px);font-weight:700;letter-spacing:.4px;color:var(--brand-strong)}
    .panel .body{padding:16px 20px;font-size:var(--small);color:var(--muted)}

    .sections{padding:20px 0 32px}
    .grid{display:grid;grid-template-columns:1fr;gap:clamp(14px,2.6vw,24px)}
    @media(min-width:720px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:1040px){.grid{grid-template-columns:repeat(3,1fr)}}
    .card{background:var(--card);border:1px solid var(--ring);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px 20px 14px;display:flex;flex-direction:column;min-height:100%}
    .card h3{margin:0 0 12px;font:800 var(--h3)/1.2 Inter,system-ui;color:var(--brand-strong);text-transform:uppercase;letter-spacing:.4px}

    .story{padding:12px 0;border-bottom:1px dashed var(--ring);transition:background .2s ease;border-radius:8px}
    .story:last-child{border-bottom:none}
    .head{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .story button.title{all:unset;cursor:pointer;color:var(--fg);font-weight:600;display:block}
    .story button.title:hover{text-decoration:underline}
    .source{display:inline-flex;align-items:center;gap:6px;font-size:var(--small);font-weight:700;text-decoration:none;padding:4px 10px;border:1px solid var(--ring);border-radius:999px;background:var(--card)}
    .source:hover{text-decoration:none;box-shadow:0 4px 14px rgba(139,0,0,.12)}
    .summary{display:none;margin-top:8px;color:var(--muted);font-size:var(--small)}
    .story.open{background:color-mix(in oklab,var(--brand) 6%,transparent);padding:16px 12px;border-radius:12px}
    .story.open .summary{display:block}
    .meta{display:block;font-size:var(--small);color:var(--muted);margin-top:auto;padding-top:14px}
    .no-results{display:none;margin:10px 0 0;color:var(--muted);font-size:var(--small)}

    .expand-wrap{display:flex;justify-content:center;margin-top:24px}

    /* Policy Tracker table */
    .table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--ring);border-radius:var(--radius);box-shadow:var(--shadow);margin-top:28px;overflow:hidden}
    .table caption{padding:14px 18px;font-weight:700;text-align:left;color:var(--brand-strong);text-transform:uppercase}
    .table th,.table td{text-align:left;padding:14px 18px;font-size:var(--body);border-bottom:1px solid var(--ring)}
    .table th{font-weight:700;background:color-mix(in oklab,var(--brand) 6%,transparent);letter-spacing:.2px}
    .table tr:last-child td{border-bottom:none}
    .badge{display:inline-block;padding:6px 12px;border-radius:999px;background:color-mix(in oklab,var(--brand) 18%,transparent);color:var(--brand);font-size:var(--small);font-weight:700;letter-spacing:.3px;text-transform:uppercase}

    footer{text-align:center;padding:32px 0 48px;color:var(--muted);font-size:var(--small)}
  </style>
</head>
<body>
  <!-- sticky controls -->
  <div class="controls">
    <div class="row">
      <div class="search" role="search">
        <input id="q" type="search" placeholder="Search headlinesâ€¦" aria-label="Search headlines" />
        <button class="btn" id="clear">Clear</button>
      </div>
      <span class="clock" id="clock">Now â€” --:--</span>
      <button class="btn" id="darkToggle" aria-pressed="false" aria-label="Toggle dark mode">ðŸŒ™</button>
    </div>
  </div>

  <!-- header -->
  <header>
    <div class="wrap">
      <h1 class="brand">Something to Report</h1>
      <p class="dek">Daily briefings with links to original sources, mobile-first layout, inline expands, and a tight three-day view.</p>
    </div>
  </header>

  <!-- date pills + last updated -->
  <div class="wrap">
    <div class="dates" id="dates">
      <span class="stamp" id="stamp">Last updated --:--</span>
    </div>
  </div>

  <!-- breaking (optional placeholder) -->
  <div class="wrap">
    <section class="panel breaking" aria-label="Breaking">
      <div class="bar" id="breakingBar">BREAKING: Placeholder â€” add to JSON to drive this</div>
      <div class="body" id="breakingBody">Short kicker line here. Add a source link once confirmed.</div>
    </section>

    <!-- sections (EMPTY SHELLS; JS will render stories) -->
    <section class="sections">
      <div class="grid" id="sections">
        <article class="card section" data-section="family">
          <h3>Family</h3>
          <div class="list"></div>
          <small class="meta">Policies impacting family structure and independence</small>
          <div class="no-results">No family-focused briefings for this date yet.</div>
        </article>

        <article class="card section" data-section="education">
          <h3>Education</h3>
          <div class="list"></div>
          <small class="meta">Admissions, funding, school choice, and campus trends</small>
          <div class="no-results">No education headlines for this date.</div>
        </article>

        <article class="card section" data-section="security">
          <h3>Security &amp; Borders</h3>
          <div class="list"></div>
          <small class="meta">State deployments and DHS/port-of-entry tech</small>
          <div class="no-results">No border/security updates for this date.</div>
        </article>

        <article class="card section" data-section="america">
          <h3>America First</h3>
          <div class="list"></div>
          <small class="meta">Treaty powers, labor/visa, finance & ratings</small>
          <div class="no-results">No domestic policy features yet for this date.</div>
        </article>

        <article class="card section" data-section="global">
          <h3>Global Lens</h3>
          <div class="list"></div>
          <small class="meta">Defense spending trendlines and market reforms abroad</small>
          <div class="no-results">No global highlights available for this date.</div>
        </article>

        <article class="card section" data-section="journal">
          <h3>Journal &amp; Ideas</h3>
          <div class="list"></div>
          <small class="meta">Send pitches to tips@somethingtoreport.com</small>
          <div class="no-results">No long-form additions on this date.</div>
        </article>
      </div>

      <!-- expand-all lives with the stories -->
      <div class="expand-wrap">
        <button class="btn" id="toggleAll" aria-pressed="false">Expand all stories</button>
      </div>
    </section>

    <!-- policy tracker (static; you can also move to JSON later) -->
    <section aria-label="Policy Tracker">
      <table class="table" role="table">
        <caption>Policy Tracker</caption>
        <thead>
          <tr><th>Topic</th><th>Status</th><th>Last Update</th></tr>
        </thead>
        <tbody>
          <tr><td>CSU Direct Admissions (SB 640)</td><td><span class="badge">Signed</span></td><td>2025-10-10</td></tr>
          <tr><td>SFSUâ€“SFUSD Local Guarantee</td><td><span class="badge">Announced</span></td><td>2025-10-24</td></tr>
          <tr><td>WHO Accord Resolution</td><td><span class="badge">In Senate</span></td><td>2025-02-10</td></tr>
          <tr><td>Operation Lone Star</td><td><span class="badge">Ongoing</span></td><td>2025-10-24</td></tr>
          <tr><td>Border Drug Boat Strikes</td><td><span class="badge">Escalating</span></td><td>2025-10-24</td></tr>
        </tbody>
      </table>
    </section>
  </div>

  <footer>Â© <span id="year"></span> Something to Report</footer>

  <script>
    // ---------- helpers ----------
    const $=(s,el=document)=>el.querySelector(s);
    const $$=(s,el=document)=>[...el.querySelectorAll(s)];
    const fmtTime=d=>d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
    const iso = (d)=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    const label = (d)=>`${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}-${d.getFullYear()}`;

    // ---------- clock + footer year ----------
    const clock=$("#clock"), stamp=$("#stamp");
    const tick=()=>clock.textContent=`Now â€” ${fmtTime(new Date())}`;
    tick(); setInterval(tick, 1000);
    stamp.textContent=`Last updated ${fmtTime(new Date())}`;
    $("#year").textContent=new Date().getFullYear();

    // ---------- dark mode ----------
    const toggle=$("#darkToggle"), root=document.documentElement;
    if(localStorage.getItem("mode")==="dark") toggle.setAttribute("aria-pressed","true");
    toggle.addEventListener("click",()=>{
      const isDark=root.getAttribute("data-theme")==="dark";
      root.setAttribute("data-theme", isDark?"light":"dark");
      localStorage.setItem("mode", isDark?"light":"dark");
      toggle.setAttribute("aria-pressed", String(!isDark));
    });

    // ---------- search ----------
    const q=$("#q"), clearBtn=$("#clear");
    function textFilter(){
      const term=q.value.trim().toLowerCase();
      $$(".card.section").forEach(card=>{
        card.style.display = card.innerText.toLowerCase().includes(term) ? "" : "none";
      });
    }
    q.addEventListener("input", textFilter);
    clearBtn.addEventListener("click", ()=>{ q.value=""; textFilter(); q.focus(); });

    // ---------- date pills (today, yesterday, day before) ----------
    const datesEl=$("#dates");
    const params=new URLSearchParams(location.search);
    const preset=params.get("date");  // label MM-DD-YYYY
    const today=new Date();
    const day = (n)=>{const d=new Date(); d.setDate(today.getDate()-n); return d;};
    const three=[day(0), day(1), day(2)];
    const pills=[];
    three.forEach((d,i)=>{
      const pill=document.createElement("button");
      pill.type="button";
      pill.className="pill";
      pill.dataset.date=label(d);
      pill.textContent=i===0?`Latest: ${label(d)}`:label(d);
      datesEl.insertBefore(pill, stamp);
      pills.push(pill);
    });

    // ---------- data loading ----------
    const DATA_BASE = "./data"; // folder where your JSON files live
    async function fetchNews(dateLabel){
      // convert MM-DD-YYYY -> YYYY-MM-DD
      const [mm,dd,yyyy] = dateLabel.split("-");
      const isoDate = `${yyyy}-${mm}-${dd}`;
      const url = `${DATA_BASE}/news-${isoDate}.json`;
      const res = await fetch(url, {cache:"no-store"});
      if(!res.ok) throw new Error(`Missing or invalid JSON for ${isoDate} at ${url}`);
      return res.json();
    }

    // ---------- render ----------
    function renderCategory(catEl, items){
      const list = $(".list", catEl);
      list.innerHTML = "";
      let shown = 0;
      (items||[]).forEach(it=>{
        // story block
        const wrap = document.createElement("div");
        wrap.className = "story";
        // head
        const head = document.createElement("div");
        head.className = "head";
        const btn = document.createElement("button");
        btn.className = "title";
        btn.textContent = it.title || "(untitled)";
        const a = document.createElement("a");
        a.className = "source";
        a.href = it.url || "#";
        a.target="_blank"; a.rel="noopener";
        a.textContent = it.sourceLabel || "Source â†—";
        head.append(btn, a);
        // summary
        const sum = document.createElement("div");
        sum.className = "summary";
        sum.textContent = it.summary || "";
        wrap.append(head, sum);
        // click to expand
        btn.addEventListener("click", ()=>{
          wrap.classList.toggle("open");
        });
        list.appendChild(wrap);
        shown++;
      });
      // empty state
      const empty = $(".no-results", catEl);
      if(empty) empty.style.display = shown ? "none" : "block";
    }

    function renderAll(data){
      // optional: breaking
      if(data.breaking){
        $("#breakingBar").textContent = data.breaking.title || "BREAKING";
        $("#breakingBody").textContent = data.breaking.kicker || "";
      } else {
        $("#breakingBar").textContent = "BREAKING: Placeholder â€” add to JSON to drive this";
        $("#breakingBody").textContent = "Short kicker line here. Add a source link once confirmed.";
      }

      // categories expected in JSON:
      // family, education, security, america, global, journal
      const map = {
        family: $('[data-section="family"]'),
        education: $('[data-section="education"]'),
        security: $('[data-section="security"]'),
        america: $('[data-section="america"]'),
        global: $('[data-section="global"]'),
        journal: $('[data-section="journal"]'),
      };
      Object.entries(map).forEach(([key, el])=>{
        renderCategory(el, data[key] || []);
      });
    }

    // ---------- date filter (fetch + render) ----------
    async function applyDate(dateLabel){
      // highlight pill
      pills.forEach(p=>p.classList.toggle("active", p.dataset.date===dateLabel));
      // reflect in URL
      const url=new URL(location.href);
      url.searchParams.set("date", dateLabel);
      history.replaceState(null,"",url.toString());
      // fetch + render
      try{
        const data = await fetchNews(dateLabel);
        renderAll(data);
      }catch(err){
        console.error(err);
        // render empty if missing
        renderAll({});
      }
    }

    // hook pills
    pills.forEach(p=>p.addEventListener("click", ()=>applyDate(p.dataset.date)));

    // initial
    const initial = preset && pills.some(p=>p.dataset.date===preset) ? preset : pills[0]?.dataset.date;
    if(initial) applyDate(initial);

    // expand/collapse all
    const toggleAll=$("#toggleAll");
    if(toggleAll){
      toggleAll.addEventListener("click", ()=>{
        const open = toggleAll.getAttribute("aria-pressed")!=="true";
        toggleAll.setAttribute("aria-pressed", String(open));
        toggleAll.textContent = open ? "Collapse all stories" : "Expand all stories";
        $$(".story").forEach(st=> st.classList.toggle("open", open));
      });
    }
  </script>
</body>
</html>